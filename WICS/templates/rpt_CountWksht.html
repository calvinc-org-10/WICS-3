{% extends "WICS_common.html" %}

{% block tTitle %}Counting Agenda/Worksheet{% endblock %}
{% block boddy %}
<!-- menu head -->
<div class="container text-center mx-auto">
    <div class="row max-width=100%">
        <div class="col-10">
            <h2>
                <u>{{ orgname }}</u>
                <br>
                Counting Agenda/Worksheet for 
                <span class="container">
                    <input type="date" id="gotoID" onchange="loadDate();" value="{{ CountDate|date:'Y-m-d' }}">
                </span>
            </h2>
            SAP Date: {{ SAP_Updated_at }}
        </div>
        <div class="col-2 text-end"> {{ uname }} </div>
    </div>
    <div class="row"> <!-- status messages -->
        <div id="wait_spinner" class="spinner-border text-success" style="display:none"></div>
    </div>
</div>

<hr>
<!-- body -->
{% comment %}
Make page changes on itm.Counter - Bootstrap pagination??
{% endcomment %}
<div class="container">
    {% for itm in CtSchd %}
        <div class="row g-0">
            <div class="col-5">
            {% if itm.NewMat3char %}
                <span class="bg-secondary fw-bold fs-5 text-white" style="width:10">
                    __ {{ itm.Material.Material|slice:"0:3" }} __
                </span>
                <br class="bg-white">
            {% endif %}
            {{ itm.MaterialBarCode|safe }}
            {{ itm.Material.Material }} |
            {{ itm.Material.PartType.WhsePartType }} | Prio: {{ itm.Priority }} |
            Sched Counter: {{ itm.Counter }}
            </div>
        </div>
        <div class="row g-0">
            <div class="col-5">{{ itm.Material.Description }}</div>
        </div>
        <div class="row g-0">
            <div class="col-5">
            Last Found On {{ itm.LastFoundAt.lastCountDate }} At {{ itm.LastFoundAt.lastFoundAt }}
            </div>
        </div>
        <div class="row g-0">
            <div class="col-5">
            Typical Container Qty = {{ itm.Material.TypicalContainerQty }},
            Typical Pallet Qty = {{ itm.Material.TypicalPalletQty }}
            </div>
        </div>
        <div class="row g-0 calvin-smalltext">
            <div class="col-12">
            Reason Scheduled: {{ itm.ReasonScheduled }} | Notes: {{ itm.Notes }} | SAP Qty: {{ itm.SAPQty }} 
            </div>
        </div>
    <hr>
    {% endfor %}
</div>
    
    <!-- form footer -->
    <hr>
    <div class="container">
        <div class="row mx-auto max-width=100%">
            <div class="col-10">
            </div>
            <div class="col-2">
                <button 
                    id="close_btn" 
                    type="button" 
                    onclick="window.close();">Close Form</button>
            </div>
        </div>
    </div>
</div>

<script>
function loadDate() {
    // send #gotoID back into the url
    dVal = $("#gotoID").val().replace(" ","%20")
    
    newRec = "{% url 'CountWorksheet' 'passedDate' %}"
    newRec = newRec.replace("/passedDate","/"+dVal);
    window.location = newRec;

};

</script>

{% endblock %}

